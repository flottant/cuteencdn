"use strict";function _instanceof(left,right){return null!=right&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?!!right[Symbol.hasInstance](left):left instanceof right}function _classCallCheck(instance,Constructor){if(!_instanceof(instance,Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function insertAtCursor(e,t){var a,s,n,i=e.scrollTop,o=document.documentElement.scrollTop;document.selection?(e.focus(),(a=document.selection.createRange()).text=t,a.select()):e.selectionStart||"0"==e.selectionStart?(s=e.selectionStart,n=e.selectionEnd,e.value=e.value.substring(0,s)+t+e.value.substring(n,e.value.length),e.focus(),e.selectionStart=s+t.length,e.selectionEnd=s+t.length):(e.value+=t,e.focus()),e.scrollTop=i,document.documentElement.scrollTop=o}!function(){var OwO=function(){function OwO(option){var _this=this;_classCallCheck(this,OwO);var defaultOption={logo:"OwO表情",container:document.getElementById("comment-emoji"),target:document.getElementById("comment-textarea"),position:"down",width:"100%",maxHeight:"250px",api:Config.staticUrl+"emoji/emoji.json"};for(var defaultKey in defaultOption)defaultOption.hasOwnProperty(defaultKey)&&!option.hasOwnProperty(defaultKey)&&(option[defaultKey]=defaultOption[defaultKey]);this.container=option.container,this.target=option.target,"up"===option.position&&this.container.classList.add("OwO-up");var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){4===xhr.readyState&&(xhr.status>=200&&xhr.status<300||304===xhr.status?(_this.odata=JSON.parse(xhr.responseText),_this.init(option)):console.log("OwO data request was unsuccessful: "+xhr.status))},xhr.open("get",option.api,!0),xhr.send(null)}return _createClass(OwO,[{key:"init",value:function(option){var _this2=this;this.area=option.target,this.packages=Object.keys(this.odata);var html='\n <div class="OwO-body" style="width: '.concat(option.width,'">');html+='\n<div class="OwO-bar">\n<ul class="OwO-packages">';for(var _i2=0;_i2<this.packages.length;_i2++)html+="\n<li><span>".concat(this.packages[_i2],"</span></li>");html+="\n                    </ul>\n                </div>";for(var i=0;i<this.packages.length;i++){html+='\n<ul class="OwO-items OwO-items-'.concat(this.odata[this.packages[i]].type,'" style="max-height: ').concat(parseInt(option.maxHeight)-53+"px",';">');for(var opackage=this.odata[this.packages[i]].container,_i=0;_i<opackage.length;_i++)html+=`\n          <li class="OwO-item" title="${opackage[_i].text}" data-id="${opackage[_i].data}"><img class="emoji" src="${Config.staticUrl+opackage[_i].icon}"/></li>\n          `;html+="</ul>"}html+="</div>",this.container.insertAdjacentHTML("beforeend",html),this.logo=document.getElementById("comment-emoji"),this.logo.addEventListener("click",function(){_this2.toggle()}),this.container.getElementsByClassName("OwO-body")[0].addEventListener("click",function(e){var t=null;e.target.classList.contains("OwO-item")?t=e.target:e.target.parentNode.classList.contains("OwO-item")&&(t=e.target.parentNode),t&&(_this2.area.selectionEnd,_this2.area.value,"not-given"==t.dataset.id?insertAtCursor(_this2.area," "+t.innerHTML+" "):insertAtCursor(_this2.area," "+t.dataset.id+" "),_this2.area.focus(),_this2.toggle())}),this.packagesEle=this.container.getElementsByClassName("OwO-packages")[0];for(var _loop=function(_i3){var index;index=_i3,_this2.packagesEle.children[_i3].addEventListener("click",function(){_this2.tab(index)})},_i3=0;_i3<this.packagesEle.children.length;_i3++)_loop(_i3);this.tab(0)}},{key:"toggle",value:function(){this.container.classList.contains("OwO-open")?this.container.classList.remove("OwO-open"):this.container.classList.add("OwO-open")}},{key:"tab",value:function(index){var itemsShow=this.container.getElementsByClassName("OwO-items-show")[0];itemsShow&&itemsShow.classList.remove("OwO-items-show"),this.container.getElementsByClassName("OwO-items")[index].classList.add("OwO-items-show");var packageActive=this.container.getElementsByClassName("OwO-package-active")[0];packageActive&&packageActive.classList.remove("OwO-package-active"),this.packagesEle.getElementsByTagName("li")[index].classList.add("OwO-package-active")}}]),OwO}();"undefined"!=typeof module&&void 0!==module.exports?module.exports=OwO:window.OwO=OwO}();